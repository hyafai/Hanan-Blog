---
title: 'Food Is All Around: How Contexts Create Misbeliefs About the Healthâ€“Taste Relationship'
author: "HANAN YAFAI"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
  word_document:
    toc: yes
    code_download: true
---

# Background:

The study investigated whether frequency constellations of food health and taste in different contexts contribute to beliefs about the health-taste relationship. We hypothesised that if there is more tasty and unhealthy food in one than another context, people will perceive an unhealthy-tasty relationship, regardless of the actual contingency between health and taste. Conversely, if there is more tasty and healthy food in one than another context, people will perceive a healthy-tasty relationship.

### [Procedure:]{.underline}

Participants viewed graphs summarising health and taste ratings (i.e., base rates) from two different food contexts, specifically delivery apps. Afterwards, they indicated to what extent they perceived a relationship between health and taste, separately in each context, as well as overall, across contexts.

### [Design:]{.underline}

4 conditions in a mixed design. Each participant viewed information about food from two contexts (within factor `context`) Participants were randomly assigned to the `harmonious` or `conflicting` base rate manipulation (between factor `condition`). In the `harmonious` base rate manipulation group, there were both more healthy and tasty foods in the first than the second context. In the `conflicting` base rate manipulation group, there were more unhealthy and tasty foods in the first than the second context.

The contexts had different names which were counter-balanced between participants (variable `random_app`).

### [Dependent measures:]{.underline}

The dependent variable was participants' perceived relationship between healthiness and tastiness, which we assessed in two ways:

Participants indicated for each context how likely they would get a tasty food when getting a healthy and an unhealthy food on two slider scales from 0% to 100% (Conditional probability estimate).

They also indicated, within each context as well as across contexts, whether the healthy or the unhealthy foods were tastier, on a slider scale from 1 = *the unhealthy meals* to 100 = *the healthy meals* (Relative contingency belief).

In addition, participants indicated what kind of food they would more likely order from any of the contexts, on a Likert scale ranging from 1 = *an unhealthy food* to 11 = *a healthy food* (Preference).

### [Manipulation checks and additional measures:]{.underline}

To ensure that participants recognized the different frequencies of healthy and tasty food across the different contexts, they estimated how many foods per context were (un)healthy and (not) tasty, respectively (Base rate estimates).

The manipulation check analyses are documented in a separate R markdown file: `Study1_manipulation_checks.Rmd`.

Additionally, we administered the protestant ethic scale (PES) to control for its possible influence in the analyses. For the control analyses, see the separate R markdown file `Study1_control.Rmd`.

We also asked participants how often they ordered food via delivery apps or websites, with answer options "Never", "Rarely", "Sometimes", and "Often". If they chose any answer other than "Never", we asked them to rate the tastiness and healthiness of the food offered by the delivery apps they used in their daily life. Descriptive analyses of these variables can be found in the separate R markdown file `Study1_control.Rmd`.

```{r, include=FALSE}
#Load required packages:

library(tidyverse)
library(misty)
library(ggplot2)
library(jtools)
library(rstatix)
library(knitr)
library(Rmisc)
```

```{r, echo=FALSE}
dat <- read.csv2("Data/Study1_data_processed.csv")
```

```{r, include=FALSE}
# Turn the id and group variables into factors and add labels to the groups.
dat <-
  dat %>% 
  mutate(id = factor(id),
         condition = factor(condition, 
                            levels = c('1', '2'), 
                            labels = c('Harmonious', 'Conflicting')),
         random_app = factor(random_app,
                                 levels = c('1', '2'),
                                 labels = c('1st "Eats", 2nd "Zanana"', '1st "Zanana", 2nd "Eats"'))
         
  )
```

# Perceived health-taste relationship within contexts

## [DV 1: Conditional probability estimate:]{.underline}

First, we tested the effects of base rate manipulation, context and their interaction on participants' conditional probability estimate. We calculated a mixed ANOVA, testing the effect of the between-subjects factor base rate manipulation (harmonious vs. conflicting), within-subjects factor context (1st vs. 2nd) and their interaction on the conditional probability estimate. We expected a significant main effect of base rate manipulation.

```{r, include=FALSE}
# Restructure data from wide into long format for the mixed ANOVA, convert the context variable into a factor.
dat_long_ce <-
  dat %>% 
  select(id, condition, condi_est_c1, condi_est_c2) %>% 
  pivot_longer(cols = c('condi_est_c1', 'condi_est_c2'), 
                       names_to = 'context',
                       values_to = 'condi_es') %>% 
  mutate(context = rec(context, '"condi_est_c1" = 1; "condi_est_c2" = 2')) %>%
  mutate(context =factor(context,
                         levels = c('1', '2'),
                         labels= c('1st Context', '2nd Context')))
```

### Descriptive statistics

```{r, echo=FALSE}
# Check the mean, standard deviation, standard error and 95% confidence interval of the conditional probability estimate in each base rate manipulation and context.
ce_sum <- summarySE(dat_long_ce, measurevar="condi_es", groupvars=c('condition', 'context'))
ce_sum %>% 
  kable(format = 'markdown', digits = 2,
        col.names = c('Base rate manipulation', 'Context','N', 'Mean contingency estimate', 'Std. Dev.', 'Std. Error', '95% CI'), 
        caption = 'Mean perceived health-taste relationship by base rate manipulation and context')


```

### ANOVA

```{r}
#| code-fold: true
aov_condi <-
  anova_test(
  data = dat_long_ce, dv = condi_es, wid = id,
  between = condition, within = context, type = 3, effect.size = 'pes')

```

```{r, echo=FALSE}
options(dplyr.summarise.inform = FALSE) # Deactivate the warning message
colnames(aov_condi) <- c('Effect','df/nominator', 'df/denominator', '$F$', '$p$', 'Sig.', 'partial $\\eta^2$')
rownames(aov_condi) <- c('Base rate manipulation', 'Context', 'Base rate manipulation*Context')

kable(aov_condi[,-1],format = 'markdown',  digits = 2,
      col.names = c('df/nominator', 'df/denominator', '$F$', '$p$', 'Sig.', 'partial $\\eta^2$')
      )
```

As expected, there was a large main effect of base rate manipulation. There was also a medium-sized effect of context as well as a large effect of the 2-way interaction between base rate manipulation and context. To follow up, we calculated pairwise comparisons between base rate manipulations within each context.

#### Pairwise comparisons

```{r}
#| code-fold: true
condi_pw <- 
  dat_long_ce %>%
  group_by(context) %>%
  pairwise_t_test(condi_es ~ condition, p.adjust.method = "bonferroni")

kable(condi_pw[,-c(2:6)], format = 'markdown', digits = 2,
        caption = 'Pairwise comparisons of the perceived health-taste relationship between contexts within each base rate manipulation',
        col.names = c('Context', '$p$', 'Sign', '$p.adj$', 'Sign. adj.'))
```

In the first context with many tasty foods, participants perceived a healthy-tasty relationship, when healthy food was also frequent and an unhealthy-tasty relationship when unhealthy food was frequent. In the second context with few tasty foods, participants' perceived health-taste relationship was slightly negative in both base rate manipulations.

### Plotting the Results:

```{r, echo=FALSE}
#| code-fold: true
ce_sum %>%
  ggplot(aes(x=condition, y=condi_es, fill=context)) + 
    geom_bar(position=position_dodge(), stat="identity") +
    geom_errorbar(aes(ymin=condi_es-ci, ymax=condi_es+ci),
                  width=.2,                   
                  position=position_dodge(.9)) +
  geom_hline(yintercept = 0) +
  coord_cartesian(ylim = c(-.5, .50))+
  theme_apa() +
  labs(x = 'Base Rate Manipulation', y = 'Mean Relationship')+
  theme(legend.position = 'top',
        axis.title.y = element_text(face = 'bold', size = 18),
        axis.title.x = element_text(face = 'bold', size = 18),
        legend.text = element_text(size = 18),
        text = element_text(size = 16))
```

## DV 2: Relative contingency belief

Next, we tested the effects of base rate manipulation, context and their interaction on participants' relative contingency belief, with the same mixed ANOVA as before.

```{r, include=FALSE}
# Restructure data into long format for the mixed ANOVA, convert the context variable into a factor.
dat_long_belief <-
  dat %>% 
  select(id, condition, belief_ht_c1_R, belief_ht_c2_R) %>% 
  pivot_longer(cols = c('belief_ht_c1_R', 'belief_ht_c2_R'), 
                       names_to = 'context',
                       values_to = 'belief_ht') %>% 
  mutate(context = rec(context, '"belief_ht_c1_R" = 1; "belief_ht_c2_R" = 2')) %>%
  mutate(context =factor(context,
                         levels = c('1', '2'),
                         labels= c('1st Context', '2nd Context')))
```

### Descriptive statistics

```{r, echo=FALSE}
# Check the mean, standard deviation, standard error and 95% confidence interval of the relative contingency belief in each base rate manipulation and context.
belief_sum <- summarySE(dat_long_belief, measurevar="belief_ht", groupvars=c('condition', 'context'))
belief_sum %>% 
  kable(format = 'markdown', digits = 2,
        col.names = c('Base rate manipulation', 'Context','N', 'Mean contingency belief', 'Std. Dev.', 'Std. Error', '95% CI'), 
        caption = 'Mean perceived health-taste relationship by base rate manipulation and context')
```

### ANOVA

```{r}
#| code-fold: true
aov_belief <-
  anova_test(
  data = dat_long_belief, dv = belief_ht, wid = id,
  between = condition, within = context, type = 3, effect.size = 'pes')
```

```{r, echo=FALSE}
colnames(aov_belief) <- c('Effect','df/nominator', 'df/denominator', '$F$', '$p$', 'Sig.', 'partial $\\eta^2$')
rownames(aov_belief) <- c('Base rate manipulation', 'Context', 'Base rate manipulation*Context')                                                 

kable(aov_belief[,-1],format = 'markdown',  digits = 2,
      col.names = c('df/nominator', 'df/denominator', '$F$', '$p$', 'Sig.', 'partial $\\eta^2$')
      )
```

#### Pairwise comparisons

```{r, echo=FALSE}
belief_pw <- 
  dat_long_belief %>%
  group_by(context) %>%
  pairwise_t_test(belief_ht ~ condition, p.adjust.method = "bonferroni")

kable(belief_pw[,-c(2:6)], format = 'markdown', digits = 2,
      caption = 'Pairwise comparisons of the perceived health-taste relationship between base rate manipulation within each context',
        col.names = c('Context', '$p$', 'Sign', '$p.adj$', 'Sign. adj.'))
```

In the first context with many tasty foods, participants perceived a healthy-tasty relationship, when healthy food was also frequent and an unhealthy-tasty relationship when unhealthy food was frequent. In the second context with few tasty foods, participants' perceived health-taste relationship was slightly negative in both base rate manipulations.

### Plotting the Results

```{r}
#| code-fold: true
belief_sum %>%
  ggplot(aes(x=condition, y=belief_ht, fill=context)) + 
    geom_bar(position=position_dodge(), stat="identity") +
    geom_errorbar(aes(ymin=belief_ht-ci, ymax=belief_ht+ci),
                  width=.2,                   
                  position=position_dodge(.9)) +
  geom_hline(yintercept = 0) +
  coord_cartesian(ylim = c(-.5, .5))+
  theme_apa() +
  labs(x = 'Base Rate Manipulation', y = 'Mean Relationship')+
  theme(legend.position = 'top',
        axis.title.y = element_text(face = 'bold', size = 18),
        axis.title.x = element_text(face = 'bold', size = 18),
        legend.text = element_text(size = 18),
        text = element_text(size = 16))

```

# Perceived health-taste relationship across contexts

Next, we tested the effects of base rate manipulation on participants' perceived health-taste relationship (Relative contingency belief) across contexts, with a one-way ANOVA.

## Descriptive statistics

```{r, echo=FALSE}
# Check the mean, standard deviation, standard error and 95% confidence interval of the relative contingency belief across contexts in each base rate manipulation
beliefov_sum <- summarySE(dat, measurevar='belief_ht_overall_R', groupvars='condition')

beliefov_sum %>% 
  kable(format = 'markdown', digits = 2,
        col.names = c('Context','N', 'Mean contingency belief', 'Std. Dev.', 'Std. Error', '95% CI'), 
        caption = 'Mean perceived health-taste relationship by base rate manipulation')
```

```{r, include=FALSE}
aov_belief_ov <-
  anova_test(
    data = dat, dv = belief_ht_overall_R,
    between = condition, type = 3, effect.size = 'pes')
```

```{r, echo=FALSE}
colnames(aov_belief_ov) <- c('Effect','df/nominator', 'df/denominator', '$F$', '$p$', 'Sig.', 'partial $\\eta^2$')
rownames(aov_belief_ov) <- 'Base rate manipulation'

kable(aov_belief_ov[,-1], format = 'markdown',  digits = 2,
      caption = 'Results of the ANOVA testing the effect of base rate manipulation on the perceived health-taste relationship across contexts')
```

## Plotting the Results

```{r, echo=FALSE}
beliefov_sum %>%
  ggplot(aes(x=condition, y=belief_ht_overall_R, fill=condition)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=belief_ht_overall_R-ci, ymax=belief_ht_overall_R+ci),
                width=.2,                   
                position=position_dodge(.9)) +
  geom_hline(yintercept = 0) +
  coord_cartesian(ylim = c(-.3, .3))+
  theme_apa() +
  labs(x = 'Base Rate Manipulation', y = 'Mean Relationship')+
  theme(legend.position = 'none',
        axis.title.y = element_text(face = 'bold', size = 18),
        axis.title.x = element_text(face = 'bold', size = 18),
        legend.text = element_text(size = 18),
        text = element_text(size = 16)) 
```

# Preference for Healthy Food:

Finally, we tested the effects of base rate manipulation on participants' preference for healthy vs. unhealthy food, with a one-way ANOVA.

## Descriptive statistics

```{r, echo=FALSE}
# Check the mean, standard deviation, standard error and 95% confidence interval of the preference for healthy food in each base rate manipulation.
preference_sum <- summarySE(dat, measurevar="preference", groupvars='condition')
preference_sum %>% 
  kable(format = 'markdown', digits = 2,
        col.names = c('Context','N', 'Mean preference', 'Std. Dev.', 'Std. Error', '95% CI'), 
        caption = 'Mean preference for healthy food by base rate manipulation')
```

```{r, include=FALSE}
aov_pref <-
  anova_test(
    data = dat, dv = preference,
    between = condition, type = 3, effect.size = 'pes')

```

```{r, echo=FALSE}
colnames(aov_pref) <- c('Effect','df/nominator', 'df/denominator', '$F$', '$p$', 'Sig.', 'partial $\\eta^2$')
rownames(aov_pref) <- 'Base rate manipulation'

kable(aov_pref[,-1], format = 'markdown',  digits = 2,
      caption = 'Results of the ANOVA testing the effect of base rate manipulation on the preference for healthy versus unhealthy food')
```

## Plotting the Results:

```{r}
#| code-fold: true

preference_sum %>%
  ggplot(aes(x=condition, y=preference, fill=condition)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=preference-ci, ymax=preference+ci),
                width=.2,                   
                position=position_dodge(.9)) +
  coord_cartesian(ylim = c(1, 11))+
  theme_apa() +
  labs(x = 'Base Rate Manipulation', y = 'Mean Preference')+
  theme(legend.position = 'none',axis.title.y = element_text(face = 'bold', size = 18),
        axis.title.x = element_text(face = 'bold', size = 18),
        legend.text = element_text(size = 18),
        text = element_text(size = 16))

```

# [Summary of Results:]{.underline}

Across both contexts, and within the context with many tasty foods, participants viewing harmonious base rates believed more strongly that healthy food tastes better than unhealthy food than participants viewing conflicting base rates.

Participants viewing harmonious base rates would more likely order a healthy meal from any context than participants viewing conflicting base rates.

Participants' perceived health-taste relationship did not differ between base rate manipulations in the context with few tasty foods.
